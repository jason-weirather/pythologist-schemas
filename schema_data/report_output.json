{
    "$schema": "https://json-schema.org/schema#",
    "type": "object",
    "description":"Define the output report single sample in InForm.",
    "definitions":{
        "qc_pass":{
            "description":"If FALSE it has failed some QC metric for inclusion.",
            "type":"boolean"
        },
        "sample_cummulative_density_row":{
            "type":"object",
            "properties":{
                "region_name":{
                    "type":"string"
                },
                "population_name":{
                    "type":"string"
                },
                "cummulative_region_area_pixels":{
                    "type":"integer"
                },
                "cummulative_region_area_mm2":{
                    "type":"numeric"
                },
                "cummulative_count":{
                    "type":"integer"
                },
                "cummulative_density_mm2":{
                    "type":"numeric"
                },
                "image_count":{
                    "type":"numeric"
                },
                "measure_qc_pass":{"$ref":"#/definitions/qc_pass"}
            },
            "additionalProperties":false,
            "required":["region_name","population_name",
                        "cummulative_region_area_pixels","cummulative_region_area_mm2","cummulative_count","cummulative_density_mm2",
                        "image_count","measure_qc_pass"
                       ]
        },
        "sample_aggregate_density_row":{
            "type":"object",
            "properties":{
                "region_name":{
                    "type":"string"
                },
                "population_name":{
                    "type":"string"
                },
                "aggregate_mean_density_mm2":{
                    "type":"numeric"
                },
                "aggregate_stddev_density_mm2":{
                    "type":["numeric","null"]
                },
                "aggregate_stderr_density_mm2":{
                    "type":["numeric","null"]
                },
                "image_count":{
                    "type":"numeric"
                },
                "aggregate_measured_image_count":{
                    "type":"numeric"
                },
                "aggregate_measure_qc_pass":{"$ref":"#/definitions/qc_pass"}
            },
            "additionalProperties":false,
            "required":["region_name","population_name",
                        "aggregate_mean_density_mm2","aggregate_stddev_density_mm2","aggregate_stderr_density_mm2",
                        "image_count","aggregate_measured_image_count","measure_qc_pass"
                       ]
        },
        "image_density_row":{
            "type":"object",
            "properties":{
                "region_name":{
                    "type":"string"
                },
                "population_name":{
                    "type":"string"
                },
                "region_area_pixels":{
                    "type":"integer"
                },
                "region_area_mm2":{
                    "type":"numeric"
                },
                "count":{
                    "type":"integer"
                },
                "density_mm2":{
                    "type":"numeric"
                },
                "measure_qc_pass":{"$ref":"#/definitions/qc_pass"}
            },
            "additionalProperties":false,
            "required":["region_name","population_name","region_area_pixels","region_area_mm2","count","density_mm2","measure_qc_pass"]
        },
        "sample_percentage_row":{
            "type":"object",
            "properties":{
                "region_name":{
                    "type":"string"
                },
                "population_name":{
                    "type":"string"
                },
                "cummulative_numerator":{
                    "type":"integer"
                },
                "cummulative_denominator_count":{
                    "type":"integer"
                },
                "cummulative_fraction":{
                    "type":["numeric","null"]
                },
                "cummulative_percent":{
                    "type":["numeric","null"]
                },
                "mean_fraction":{
                    "type":["numeric","null"]
                },
                "stdev_fraction":{
                    "type":["numeric","null"]
                },
                "stderr_fraction":{
                    "type":["numeric","null"]
                },
                "mean_percent":{
                    "type":["numeric","null"]
                },
                "stdev_percent":{
                    "type":["numeric","null"]
                },
                "stderr_percent":{
                    "type":["numeric","null"]
                },
                "image_count":{
                    "type":"integer"
                },
                "measured_image_count":{
                    "type":"integer"
                },
                "qc_pass":{"$ref":"#/definitions/qc_pass"}
            },
            "additionalProperties":false,
            "required":["region_name","population_name",
                        "cummulative_denominator_count","cummulative_denominator_count","cummulative_fraction","cummulative_percent",
                        "mean_fraction","stdev_fraction","stderr_fraction","mean_percent","stdev_percent",
                        "image_count","measured_image_count","pass"
                       ]
        },
        "image_percentage_row":{
            "type":"object",
            "properties":{
                "region_name":{
                    "type":"string"
                },
                "population_name":{
                    "type":"string"
                },
                "numerator_count":{
                    "type":"integer"
                },
                "denominator_count":{
                    "type":"integer"
                },
                "fraction":{
                    "type":["numeric","null"]
                },
                "percent":{
                    "type":["numeric","null"]
                },
                "qc_pass":{"$ref":"#/definitions/qc_pass"}
            },
            "additionalProperties":false,
            "required":["region_name","population_name","numerator_count","denominator_count","fraction","percent","pass"]
        }
    },
    "properties":{
        "parameters":{
            "type":"object",
            "properties":{
                "sample_name":{
                    "type":"string"
                },
                "run_id":{
                    "type":"string"
                }
            },
            "additionalProperties":false,
            "required":["sample_name","run_id"]
        },
        "sample_reports":{
            "type":"object",
            "properties":{
                "sample_cummulative_count_densities":{
                    "description":"Report for aggrogated measurements within a sample for density.",
                    "type":"array",
                    "items":{"$ref":"#/definitions/sample_cummulative_density_row"}
                },
                "sample_aggregate_count_densities":{
                    "description":"Report for aggrogated measurements within a sample for density.",
                    "type":"array",
                    "items":{"$ref":"#/definitions/sample_aggregate_density_row"}
                },
                "sample_count_percentages":{
                    "description":"Report for aggrogated measurements within a sample for percentages.",
                    "type":"array",
                    "items":{"$ref":"#/definitions/sample_percentage_row"}
                }
            },
            "additionalProperties":false,
            "required":["sample_cummulative_count_densities","sample_aggregate_count_densities","sample_count_percentages"]
        },
        "images":{
            "type":"array",
            "items":{
                "type":"object",
                "properties":{
                    "image_name":{
                        "type":"string"
                    },
                    "image_reports":{
                        "type":"object",
                        "properties":{
                            "image_count_densities":{
                                "description":"Report for density in a given image.",
                                "type":"array",
                                "items":{"$ref":"#/definitions/image_density_row"}
                            },
                            "image_count_percentages":{
                                "description":"Report for measurements within a frame for percentages.",
                                "type":"array",
                                "items":{"$ref":"#/definitions/image_percentage_row"}
                            }
                        },
                        "required":["image_count_densities","image_count_percentages"]
                    }
                },
                "additionalProperties":false,
                "required":["image_name","images"]
            }
        },
    },
    "additionalProperties":false,
    "required":["sample_name","sample_reports","image_reports"]
}
